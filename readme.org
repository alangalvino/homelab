#+TITLE: Homelab Documentation

* Homelab Overview
This homelab consists of: 
  - Three Mac Mini nodes running Proxmox VE
  - Synology NAS for shared storage
  - Alpine VM for backup
  - Kubernetes cluster on top of talos
  - Apps deployed on top of Kubernetes (exceptions are Home Assistant
    and Alpine NFS Backup server)
  - Entire environment configured with Terraform for full automation
* Hardware Summary
| Node         | CPU                       | RAM   | Storage                           | Role                                                                                     |
|--------------+---------------------------+-------+-----------------------------------+------------------------------------------------------------------------------------------|
| Mac Mini #1  | Intel Core i5-4278U       | 8 GB  | 1 TB HDD                          | Proxmox node running: Backup VM, Home Assistant VM, Kubernetes Control Plane on Talos VM |
| Mac Mini #2  | Intel Core i5-4260U       | 16 GB | 500 GB SSD                        | Proxmox node running: Kurbentes Worker on Talos VM                                       |
| Mac Mini #3  | Intel Core i5-4260U       | 16 GB | 500 GB SSD                        | Proxmox node running: Kurbentes Worker on Talos VM                                       |
| Synology NAS | Realtek RTD1296 Quad-Core | 2 GB  | 4 x 4TB HDD in SHR2 (≈8TB usable) | Synology DS418 (NFS storage for containers)                                              |
* Network Layout
- All VMs and containers share the subnet: 192.168.50.0/24
- Static IP allocations separate hosts, VMs, and containers for clarity
* Architecture Diagram
#+BEGIN_SRC text :exports both :results verbatim
               +-----------------------------------------+
               |            Proxmox Cluster              |
               +------------------+----------------------+ 
               |                  |                      |
       +-----------------+ +------------------+ +----------------------+
       | Mac Mini #1     | | Mac Mini #2      | | Mac Mini #3          |
       | 192.168.50.10   | | 192.168.50.11    | | 192.168.50.12        |
       +-------+---------+ +--------+---------+ +--------+-------------+
               |                    |                    |
     +----------------------+ +-----------------+ +--------------------+
     | Portainer Server VM  | | Portainer Agent | | Backup VM (Alpine) |
     | - Caddy Container    | | Nextcloud       | | Monitoring VM      |
     | - Pi-hole Container  | | Immich          | | Home Assistant VM  |
     | - Homepage Container | | Paperless-ngx   | +--------------------+
     +----------------------+ +-----------------+

                               |
                               v
              +---------------------------------------+
              |          Synology NAS (DS418)         |
              |          192.168.50.13                |
              +---------------------------------------+
#+END_SRC
#+CAPTION: ASCII Logical architecture showing VM roles, container placement, and storage connectivity.
* Static IP Addressing Scheme

| Device/Service            |     IP Address |
|---------------------------+----------------|
| Synology NAS              |  192.168.50.10 |
| Mac Mini #1 (Proxmox)     |  192.168.50.11 |
| Mac Mini #2 (Proxmox)     |  192.168.50.12 |
| Mac Mini #3 (Proxmox)     |  192.168.50.13 |
| Kubernetes Master         |  192.168.50.21 |
| Kubernetes Worker #1      |  192.168.50.22 |
| Kubernetes Worker #2      |  192.168.50.23 |
| Alpine Backup Server      |  192.168.50.24 |
| Home Assistant            |  192.168.40.25 |
| Pi-hole (DNS)             | 192.168.50.101 |
| Homepage (Static site)    | 192.168.50.102 |
| Immich (Image storage)    | 192.168.50.103 |
| Paperless-ngx (Documents) | 192.168.50.104 |
| Nextcloud (Backup sync)   | 192.168.50.105 |
* Proxmox Cluster Architecture Overview
:PROPERTIES:
:CREATED_AT: [2023-12-10 18:01:37]
:END:
** Proxmox pve1
:PROPERTIES:
:CREATED_AT: [2023-12-10 18:01:58]
:END:
- hostname: pve1.home.arpa
- ip: 192.168.50.11
- url: https://192.168.50.11:8006
- user: root
- password: on KeepassXC
- hardware:
  - model: Mac Mini 
  - CPU: Intel Core i5-4278U CPU @ 2.60GHz
  - RAM: 8 GB
  - Storage: 1 TB HDD
** Proxmox pve2
:PROPERTIES:
:CREATED_AT: [2023-12-10 18:01:58]
:END:
- hostname: pve2.home.arpa
- ip: 192.168.50.12
- url: https://192.168.50.12:8006
- user: root
- password: on KeepassXC
- hardware:
  - model: Mac Mini #2
  - CPU: Intel Core i5-4260U CPU @ 1.40GHz
  - RAM: 16 GB
  - Storage: 500 GB SSD
** Proxmox pve3
:PROPERTIES:
:CREATED_AT: [2023-12-27 16:26:14]
:END:
- hostname: pve3.home.arpa
- ip: 192.168.50.13
- url: https://192.168.50.13:8006
- user: root
- password: on KeepassXC
- hardware:
  - model: Mac Mini #3
  - CPU: Intel Core i5-4260U CPU @ 1.40GHz
  - RAM: 16 GB
  - Storage: 500 GB SSD
** Synology NAS (DS418)
:PROPERTIES:
:CREATED_AT: [2023-12-10 18:02:00]
:END:
- hostname: nas.home.arpa
- ip: 192.168.50.10
- hardware:
  - CPU: Realtek RTD1296 Quad-Core
  - RAM: 2 GB
  - Storage: 4 x 4TB HDD (SHR2 ≈8TB usable)
    
* Backup Strategy
- Synology runs SHR2 for primary data resilience
- Alpine NFS Backup Server VM runs scheduled jobs to create daily backups of Synology volume
- Cloud encrypted backup via Synology (cloud provider TBD)
- Yearly backup to an external HDD
* Homelab Data File Structure Layout
#+BEGIN_SRC text :exports both :results verbatim
/volume1/
├── homelab/
│   ├── apps/
│   ├── proxmox/
│   ├── terraform/
│   └── kubernetes/
├── users/
├── backups/
└── public/
#+END_SRC
